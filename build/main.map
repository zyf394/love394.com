{"version":3,"sources":["webpack:///webpack/bootstrap bc5fdf29c8f4cf9bacbe","webpack:///./~/babel-runtime/regenerator/index.js","webpack:///./utils/errno.js","webpack:///./utils/ctx.js","webpack:///external \"moment\"","webpack:///external \"path\"","webpack:///external \"url\"","webpack:///./nuxt.config.js","webpack:///./server/routes/index.js","webpack:///external \"koa\"","webpack:///external \"nuxt\"","webpack:///./server/api/index.js","webpack:///./server/api/member.js","webpack:///./server/api/user.js","webpack:///./server/db/auth.js","webpack:///./server/db/index.js","webpack:///./server/token/index.js","webpack:///external \"fs\"","webpack:///external \"jsonwebtoken\"","webpack:///external \"koa-bodyparser\"","webpack:///external \"koa-mongo\"","webpack:///external \"koa-router\"","webpack:///external \"koa-session2\"","webpack:///external \"mongodb\"","webpack:///external \"objectid-to-timestamp\"","webpack:///external \"postcss-px2rem\"","webpack:///external \"querystring\"","webpack:///external \"regenerator-runtime\"","webpack:///external \"sha1\"","webpack:///external \"webpack\"","webpack:///./server/index.js"],"names":["SUCCESS","errno","errmsg","MEMBER_EXIST","MEMBER_ENROLLED","MEMBER_NOT_CLASSMATE","MEMBER_PAYED","USER_NAME_REGISTERED","USER_EMAIL_REGISTERED","USER_EMAIL_NOT_REGISTERED","USER_PASSWORD_INCORRECT","USER_NOT_EXIST","ctx","next","type","status","body","ERRORS","responseError","data","responseSuccess","require","join","resolve","fs","webpack","content","readFileSync","module","exports","router","middleware","head","title","meta","charset","name","hid","link","rel","href","script","innerHTML","__dangerouslyDisableSanitizers","css","src","lang","loading","color","build","rules","test","loaders","loader","query","limit","use","exclude","vendor","postcss","remUnit","app","nuxt","createApi","session","key","mongo","user","auth","username","pass","password","host","port","db","bodyParser","routes","allowedMethods","render","req","res","member","post","add","edit","remove","get","findAll","editAll","request","collection","find","toArray","exits","length","phone","is_payed","is_enrolled","enrolled_time","Date","payed_time","insert","result","_id","ObjectId","deleteOne","ok","console","log","findOne","url","parse","skipNum","page","limitNum","parseInt","pageSize","MemberModel","skip","list","i","update","pay_time","upsert","keys","Object","exist","_serielizeUpdate","updateOne","now","forEach","item","moment","format","method","existName","email","existEmail","sha1","token","createToken","create_time","signup","userExist","cookies","set","signin","all","memberCache","userCache","User","user_email","jwt","sign","expiresIn","header","split","decoded","decode","exp","message","checkToken","config","dev","env","error","process","exit","listen","start","HOST","PORT"],"mappings":";;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AChEA;;;;;;;;ACAA,4CAAe;AACbA,WAAS;AACPC,WAAO,CADA;AAEPC,YAAQ;AAFD,GADI;AAKbC,gBAAc;AACZF,WAAO,KADK;AAEZC,YAAQ;AAFI,GALD;AASbE,mBAAiB;AACfH,WAAO,KADQ;AAEfC,YAAQ;AAFO,GATJ;AAabG,wBAAsB;AACpBJ,WAAO,KADa;AAEpBC,YAAQ;AAFY,GAbT;AAiBbI,gBAAc;AACZL,WAAO,KADK;AAEZC,YAAQ;AAFI,GAjBD;AAqBbK,wBAAsB;AACpBN,WAAO,KADa;AAEpBC,YAAQ;AAFY,GArBT;AAyBbM,yBAAuB;AACrBP,WAAO,KADc;AAErBC,YAAQ;AAFa,GAzBV;AA6BbO,6BAA2B;AACzBR,WAAO,KADkB;AAEzBC,YAAQ;AAFiB,GA7Bd;AAiCbQ,2BAAyB;AACvBT,WAAO,KADgB;AAEvBC,YAAQ;AAFe,GAjCZ;AAqCbS,kBAAgB;AACdV,WAAO,KADO;AAEdC,YAAQ;AAFM;AArCH,CAAf,C;;;;;;;;;;;;;;;;ACAA;;AAEA;AAAA,wJAAO,iBAA6BU,GAA7B,EAAkCC,IAAlC,EAAwCC,IAAxC;AAAA;AAAA;AAAA;AAAA;AACLF,gBAAIG,MAAJ,GAAa,GAAb;AACAH,gBAAII,IAAJ,GAAW;AACTf,qBAAO,uDAAAgB,CAAOH,IAAP,EAAab,KADX;AAETC,sBAAQ,uDAAAe,CAAOH,IAAP,EAAaZ;AAFZ,aAAX;;AAFK,kBAMD,OAAOW,IAAP,KAAgB,UANf;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAOGA,MAPH;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAP;;AAAA,kBAAsBK,aAAtB;AAAA;AAAA;AAAA;AAUA;AAAA,yJAAO,kBAA+BN,GAA/B,EAAoCC,IAApC;AAAA,QAA0CM,IAA1C,uEAAiD,EAAjD;AAAA;AAAA;AAAA;AAAA;AACLP,gBAAIG,MAAJ,GAAa,GAAb;AACAH,gBAAII,IAAJ,GAAW;AACTf,qBAAO,CADE;AAETC,sBAAQ,SAFC;AAGTiB;AAHS,aAAX;;AAFK,kBAOD,OAAON,IAAP,KAAgB,UAPf;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAQGA,MARH;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAP;;AAAA,kBAAsBO,eAAtB;AAAA;AAAA;AAAA,I;;;;;;ACZA,mC;;;;;;ACAA,iC;;;;;;ACAA,gC;;;;;;eCA0B,mBAAAC,CAAQ,CAAR,C;IAAlBC,I,YAAAA,I;IAAMC,O,YAAAA,O;;AACd,IAAMC,KAAK,mBAAAH,CAAQ,EAAR,CAAX;AACA,IAAMI,UAAU,mBAAAJ,CAAQ,EAAR,CAAhB;AACA,IAAMK,UAAUF,GAAGG,YAAH,CAAgBJ,QAAQ,oBAAR,CAAhB,EAA+C,MAA/C,CAAhB;;AAEAK,OAAOC,OAAP,GAAiB;AACf;;;AAGAC,UAAQ;AACNC,gBAAY;AADN,GAJO;AAOfC,QAAM;AACJC,WAAO,SADH;AAEJC,UAAM,CACJ,EAAEC,SAAS,OAAX,EADI,EAEJ,EAAEC,MAAM,UAAR,EAAoBV,SAAS,uDAA7B,EAFI,EAGJ,EAAEU,MAAM,kBAAR,EAA4BV,SAAS,cAArC,EAHI,EAIJ,EAAEW,KAAK,aAAP,EAAsBD,MAAM,aAA5B,EAA2CV,SAAS,iBAApD,EAJI,CAFF;AAQJY,UAAM,CACJ,EAAEC,KAAK,MAAP,EAAezB,MAAM,cAArB,EAAqC0B,MAAM,cAA3C,EADI,CARF;AAWJC,YAAQ,CACN;AACEC,iBAAWhB;AADb,KADM,CAXJ;AAgBJiB,oCAAgC,CAAC,QAAD;AAhB5B,GAPS;AAyBf;;;AAGAC,OAAK,CACH;AACEC,SAAKtB,QAAQ,yBAAR,CADP;AAEEuB,UAAM;AAFR,GADG,EAKH;AACED,SAAKtB,QAAQ,4BAAR,CADP;AAEEuB,UAAM;AAFR,GALG,EASH;AACED,SAAKtB,QAAQ,wBAAR,CADP;AAEEuB,UAAM,QAFR,CAGE;AAHF,GATG,CA5BU;AA0Cf;;;AAGAC,WAAS;AACPC,WAAO;AADA,GA7CM;AAgDfC,SAAO;AACLrB,YAAQ;AACNsB,aAAO,CACL;AACE;AACAC,cAAM,yBAFR;AAGEC,iBAAS,CACP;AACEC,kBAAQ,YADV;AAEEC,iBAAO;AACLC,mBAAO,IADF;AAELnB,kBAAM;AAFD;AAFT,SADO;AAHX,OADK,EAcL;AACEe,cAAM,SADR;AAEEK,aAAK,CAAC,aAAD;AAFP,OAdK,EAkBL;AACEL,cAAM,eADR;AAEEK,aAAK,CAAC,YAAD;AAFP,OAlBK,EAsBL;AACE;AACAL,cAAM,OAFR;AAGEM,iBAAS,cAHX;AAIED,aAAK,CAAC,cAAD;AAJP,OAtBK;AADD,KADH;AAgCLE,YAAQ,CACN,OADM,CAhCH;AAmCLC,aAAS,CACP,mBAAAtC,CAAQ,EAAR,EAA0B,EAACuC,SAAS,MAAV,EAA1B,CADO;AAnCJ;AAhDQ,CAAjB,C;;;;;;;;;;;;;;;;;;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4CAAe,UAASC,GAAT,EAAcC,IAAd,EAAoB;AAAA;;AACjC,MAAMhC,SAAS,IAAI,kDAAJ,EAAf;;AAEAiC,EAAA,4EAAAA,CAAUjC,MAAV;;AAEA+B,MACGL,GADH,CACO,oDAAAQ,CAAQ;AACXC,SAAK;AADM,GAAR,CADP;;AAKAJ,MACGL,GADH,CACO,iDAAAU,CAAM;AACTC,UAAM,yDAAAC,CAAKC,QADF;AAETC,UAAM,yDAAAF,CAAKG,QAFF;AAGTC,UAAM,WAHG;AAITC,UAAM,KAJG;AAKTC,QAAI;AALK,GAAN,CADP,EAQGlB,GARH,CAQO,sDAAAmB,EARP,EASGnB,GATH,CASO1B,OAAO8C,MAAP,EATP,EAUGpB,GAVH,CAUO1B,OAAO+C,cAAP,EAVP,EAWGrB,GAXH;AAAA,0JAWO,iBAAO5C,GAAP,EAAYC,IAAZ;AAAA;AAAA;AAAA;AAAA;AACHD,kBAAIG,MAAJ,GAAa,GAAb,CADG,CACc;AADd;AAAA,qBAEG+C,KAAKgB,MAAL,CAAYlE,IAAImE,GAAhB,EAAqBnE,IAAIoE,GAAzB,CAFH;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAXP;;AAAA;AAAA;AAAA;AAAA;AAeD,C;;;;;;ACjCD,gC;;;;;;ACAA,iC;;;;;;;;;ACAA;AACA;AACA,4CAAe,UAASlD,MAAT,EAAiB;AAC9BmD,EAAA,+EAAAA,CAAOnD,MAAP;AACAqC,EAAA,6EAAAA,CAAKrC,MAAL;AACD,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACLD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAAe,UAAUA,MAAV,EAAkB;AAC/BA,SAAOoD,IAAP,CAAY,iBAAZ,EAA+BC,GAA/B;AACArD,SAAOoD,IAAP,CAAY,kBAAZ,EAAgCE,IAAhC;AACAtD,SAAOoD,IAAP,CAAY,oBAAZ,EAAkCG,MAAlC;AACAvD,SAAOwD,GAAP,CAAW,kBAAX,EAA+BC,OAA/B;AACAzD,SAAOoD,IAAP,CAAY,kBAAZ,EAAgCM,OAAhC;AACD;;AAED;AAAA,wJAAO,iBAAoB5E,GAApB,EAAyBC,IAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AACCkE,eADD,GACOnE,IAAI6E,OAAJ,CAAYzE,IADnB;AAECsC,iBAFD,GAES,EAAElB,MAAM2C,IAAI3C,IAAZ,EAFT;AAAA;AAAA,mBAGexB,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,QAAlC,EAA4CC,IAA5C,CAAiDrC,KAAjD,EAAwDsC,OAAxD,EAHf;;AAAA;AAGCC,iBAHD;;AAAA,iBAKDA,MAAMC,MALL;AAAA;AAAA;AAAA;;AAMH5E,YAAA,wFAAAA,CAAcN,GAAd,EAAmBC,IAAnB,EAAyB,cAAzB;AANG;AAAA;;AAAA;AAQGoE,kBARH,GAQY;AACb7C,oBAAM2C,IAAI3C,IAAJ,IAAY,EADL;AAEb2D,qBAAOhB,IAAIgB,KAAJ,IAAa,EAFP;AAGbC,wBAAUjB,IAAIiB,QAAJ,IAAgB,CAHb;AAIbC,2BAAalB,IAAIkB,WAAJ,IAAmB,CAJnB;AAKbC,6BAAe,CAAC,IAAIC,IAAJ,EALH;AAMbC,0BAAY,CAAC,IAAID,IAAJ;AANA,aARZ;AAAA;AAAA,mBAgBkBvF,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,QAAlC,EAA4CW,MAA5C,CAAmDpB,MAAnD,CAhBlB;;AAAA;AAgBGqB,kBAhBH;;AAiBHlF,YAAA,0FAAAA,CAAgBR,GAAhB,EAAqBC,IAArB;;AAjBG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAP;;AAAA,kBAAsBsE,GAAtB;AAAA;AAAA;AAAA;AAoBA;AAAA,yJAAO,kBAAuBvE,GAAvB,EAA4BC,IAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AACCyC,iBADD,GACS1C,IAAI6E,OAAJ,CAAYzE,IAAZ,IAAoB,EAD7B;;AAELsC,kBAAMiD,GAAN,GAAY,wEAAAC,CAASlD,MAAMiD,GAAf,CAAZ;AAFK;AAAA;AAAA,mBAIkB3F,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,QAAlC,EAA4Ce,SAA5C,CAAsDnD,KAAtD,CAJlB;;AAAA;AAIGgD,kBAJH;;AAKH,gBAAIA,OAAOA,MAAP,CAAcI,EAAlB,EAAsB;AACpBtF,cAAA,0FAAAA,CAAgBR,GAAhB,EAAqBC,IAArB;AACD;AAPE;AAAA;;AAAA;AAAA;AAAA;;AASH8F,oBAAQC,GAAR;;AATG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAP;;AAAA,kBAAsBvB,MAAtB;AAAA;AAAA;AAAA;AAYA;AAAA,yJAAO,kBAAwBzE,GAAxB,EAA6BC,IAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AACCyC,iBADD,GACS1C,IAAI6E,OAAJ,CAAYzE,IAAZ,IAAoB,EAD7B;;AAELsC,kBAAMiD,GAAN,GAAY,wEAAAC,CAASlD,MAAMiD,GAAf,CAAZ;AAFK;AAAA,mBAGY3F,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,QAAlC,EAA4CC,IAA5C,CAAiDrC,KAAjD,EAAwDsC,OAAxD,EAHZ;;AAAA;AAGLhF,gBAAII,IAHC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAP;;AAAA,kBAAsB6F,OAAtB;AAAA;AAAA;AAAA;AAKA;AAAA,yJAAO,kBAAuBjG,GAAvB,EAA4BC,IAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AACCyC,iBADD,GACS,2CAAAwD,CAAIC,KAAJ,CAAUnG,IAAI6E,OAAJ,CAAYqB,GAAtB,EAA2B,IAA3B,EAAiCxD,KAD1C;AAEC0D,mBAFD,GAEW,CAAC1D,MAAM2D,IAAN,GAAa,CAAd,IAAmB,EAF9B;AAGCC,oBAHD,GAGYC,SAAS7D,MAAM8D,QAAf,CAHZ;AAAA;AAAA;AAAA,mBAKc,qFAAAC,CAAYzG,GAAZ,EAAiB+E,IAAjB,CAAsB,EAAtB,EAA0B2B,IAA1B,CAA+BN,OAA/B,EAAwCzD,KAAxC,CAA8C2D,QAA9C,EAAwDtB,OAAxD,EALd;;AAAA;AAKHhF,gBAAII,IALD;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAOH2F,oBAAQC,GAAR;;AAPG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAP;;AAAA,kBAAsBrB,OAAtB;AAAA;AAAA;AAAA;AAUA;AAAA,yJAAO,kBAAuB3E,GAAvB,EAA4BC,IAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AACCkE,eADD,GACOnE,IAAI6E,OAAJ,CAAYzE,IADnB;AAECuG,gBAFD,GAEQxC,IAAI5D,IAAJ,IAAY,EAFpB;AAAA;AAKMqG,aALN,GAKU,CALV;;AAAA;AAAA,kBAKaA,IAAID,KAAKzB,MALtB;AAAA;AAAA;AAAA;;AAMGxC,iBANH,GAMW;AACViD,mBAAK,wEAAAC,CAASe,KAAKC,CAAL,EAAQjB,GAAjB;AADK,aANX;AASGkB,kBATH,GASY;AACX,sBAAQ;AACNrF,sBAAMmF,KAAKC,CAAL,EAAQpF,IADR;AAEN2D,uBAAOwB,KAAKC,CAAL,EAAQzB,KAFT;AAGNC,0BAAUuB,KAAKC,CAAL,EAAQxB,QAHZ;AAINC,6BAAasB,KAAKC,CAAL,EAAQvB,WAJf;AAKNC,+BAAeqB,KAAKC,CAAL,EAAQtB,aALjB;AAMNwB,0BAAUH,KAAKC,CAAL,EAAQE;AANZ;AADG,aATZ;AAAA;AAAA;AAAA,mBAoBoB9G,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,QAAlC,EAA4C+B,MAA5C,CAAmDnE,KAAnD,EAA0DmE,MAA1D,EAAkE,EAAEE,QAAQ,IAAV,EAAlE,CApBpB;;AAAA;AAoBKrB,kBApBL;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAsBCK,oBAAQC,GAAR;;AAtBD;AAK8BY,eAL9B;AAAA;AAAA;;AAAA;AAyBHpG,YAAA,0FAAAA,CAAgBR,GAAhB,EAAqBC,IAArB;AAzBG;AAAA;;AAAA;AAAA;AAAA;;AA2BH8F,oBAAQC,GAAR;;AA3BG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAP;;AAAA,kBAAsBpB,OAAtB;AAAA;AAAA;AAAA;AA8BA;AAAA,yJAAO,kBAAqB5E,GAArB,EAA0BC,IAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AACDkE,eADC,GACKnE,IAAI6E,OAAJ,CAAYzE,IADjB;AAED4G,gBAFC,GAEMC,OAAOD,IAAP,CAAY7C,GAAZ,CAFN;AAGDzB,iBAHC,GAGO;AACVlB,oBAAM2C,IAAI3C;AADA,aAHP;AAMDqF,kBANC,GAMQ,EANR;AAAA;AAAA,mBAOe7G,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,QAAlC,EAA4CC,IAA5C,CAAiDrC,KAAjD,EAAwDsC,OAAxD,EAPf;;AAAA;AAOCkC,iBAPD;;AAAA,iBASDA,MAAMhC,MATL;AAAA;AAAA;AAAA;;AAAA,kBAUCf,IAAIkB,WAAJ,IAAmB6B,MAAM,CAAN,EAAS7B,WAV7B;AAAA;AAAA;AAAA;;AAWD/E,YAAA,wFAAAA,CAAcN,GAAd,EAAmBC,IAAnB,EAAyB,iBAAzB;AAXC;AAAA;;AAAA;AAAA,kBAYQkE,IAAIiB,QAAJ,IAAgB8B,MAAM,CAAN,EAAS9B,QAZjC;AAAA;AAAA;AAAA;;AAaD9E,YAAA,wFAAAA,CAAcN,GAAd,EAAmBC,IAAnB,EAAyB,cAAzB;AAbC;AAAA;;AAAA;AAeD4G,qBAASM,iBAAiBhD,GAAjB,CAAT;AAfC;AAAA;AAAA,mBAiBsBnE,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,QAAlC,EAA4CsC,SAA5C,CAAsD1E,KAAtD,EAA6DmE,MAA7D,CAjBtB;;AAAA;AAiBOnB,kBAjBP;;AAkBC,gBAAIA,OAAOA,MAAP,CAAcI,EAAlB,EAAsB;AACpBtF,cAAA,0FAAAA,CAAgBR,GAAhB,EAAqBC,IAArB;AACD,aAFD,MAEO;AACL8F,sBAAQC,GAAR,CAAYN,OAAOA,MAAnB;AACD;AAtBF;AAAA;;AAAA;AAAA;AAAA;;AAwBCK,oBAAQC,GAAR;;AAxBD;AAAA;AAAA;;AAAA;AA4BH1F,YAAA,wFAAAA,CAAcN,GAAd,EAAmBC,IAAnB,EAAyB,sBAAzB;;AA5BG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAP;;AAAA,kBAAsBuE,IAAtB;AAAA;AAAA;AAAA;;AAgCA,SAAS2C,gBAAT,CAA2BhD,GAA3B,EAAgC;AAC9B,MAAI0C,SAAS,EAAb;AACA,MAAIQ,MAAM,CAAC,IAAI9B,IAAJ,EAAX;AACA,MAAI7C,QAAQyB,GAAZ;AACA,MAAI6C,OAAOC,OAAOD,IAAP,CAAY7C,GAAZ,CAAX;AACA6C,OAAKM,OAAL,CAAa,gBAAQ;AACnB,QAAI,CAACT,OAAO,MAAP,CAAL,EAAqB;AACnBA,aAAO,MAAP,IAAiB,EAAjB;AACD;AACD,QAAIU,SAAS,KAAb,EAAoB;AAClB,UAAIA,SAAS,aAAT,IAA0B7E,MAAM2C,WAAN,KAAsB,CAApD,EAAuD;AACrDwB,eAAO,MAAP,EAAe,eAAf,IAAkC,8CAAAW,CAAOH,GAAP,EAAYI,MAAZ,CAAmB,qBAAnB,CAAlC;AACD;AACD,UAAIF,SAAS,UAAT,IAAuB7E,MAAM0C,QAAN,KAAmB,CAA9C,EAAiD;AAC/CyB,eAAO,MAAP,EAAe,YAAf,IAA+B,8CAAAW,CAAOH,GAAP,EAAYI,MAAZ,CAAmB,qBAAnB,CAA/B;AACD;AACDZ,aAAO,MAAP,EAAeU,IAAf,IAAuBpD,IAAIoD,IAAJ,CAAvB;AACD;AACF,GAbD;AAcA,SAAOV,MAAP;AACD,C;;;;;;;;;;;;;;;;;;;;;;;wJClID,iBAAuB7G,GAAvB,EAA4BC,IAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AACMkE,eADN,GACYnE,IAAI0H,MAAJ,KAAe,KAAf,GACI,2CAAAxB,CAAIC,KAAJ,CAAUnG,IAAI6E,OAAJ,CAAYqB,GAAtB,EAA2B,IAA3B,EAAiCxD,KADrC,GAEI1C,IAAI6E,OAAJ,CAAYzE,IAH5B;AAAA;AAAA,mBAIwBJ,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,MAAlC,EAA0CC,IAA1C,CAA+C,EAAEtB,UAAUU,IAAIV,QAAJ,IAAgB,EAA5B,EAA/C,EAAgFuB,OAAhF,EAJxB;;AAAA;AAIM2C,qBAJN;AAAA;AAAA,mBAKyB3H,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,MAAlC,EAA0CC,IAA1C,CAA+C,EAAE6C,OAAOzD,IAAIyD,KAAJ,IAAa,EAAtB,EAA/C,EAA0E5C,OAA1E,EALzB;;AAAA;AAKM6C,sBALN;;AAAA,iBAOMF,UAAUzC,MAPhB;AAAA;AAAA;AAAA;;AAQI5E,YAAA,wFAAAA,CAAcN,GAAd,EAAmBC,IAAnB,EAAyB,sBAAzB;AARJ;AAAA;;AAAA;AAAA,iBAUQ4H,WAAW3C,MAVnB;AAAA;AAAA;AAAA;;AAWM5E,YAAA,wFAAAA,CAAcN,GAAd,EAAmBC,IAAnB,EAAyB,uBAAzB;AAXN;AAAA;;AAAA;AAaUoH,eAbV,GAagB,CAAC,IAAI9B,IAAJ,EAbjB;AAcUhC,gBAdV,GAciB;AACTE,wBAAUU,IAAIV,QADL;AAETmE,qBAAOzD,IAAIyD,KAFF;AAGTjE,wBAAU,4CAAAmE,CAAK3D,IAAIR,QAAT,CAHD,EAGqB;AAC9BoE,qBAAO,kFAAAC,CAAY7D,IAAIyD,KAAhB,CAJE,EAIsB;AAC/BK,2BAAa,8CAAAT,CAAOH,GAAP,EAAYI,MAAZ,CAAmB,qBAAnB;AALJ,aAdjB;AAAA;AAAA,mBAqByBzH,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,MAAlC,EAA0CW,MAA1C,CAAiDlC,IAAjD,CArBzB;;AAAA;AAqBUmC,kBArBV;;;AAuBMlF,YAAA,0FAAAA,CAAgBR,GAAhB,EAAqBC,IAArB;;AAvBN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;kBAAeiI,M;;;;;;yJA4Bf,kBAAuBlI,GAAvB,EAA4BC,IAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AACMkE,eADN,GACYnE,IAAI0H,MAAJ,KAAe,KAAf,GACE,2CAAAxB,CAAIC,KAAJ,CAAUnG,IAAI6E,OAAJ,CAAYqB,GAAtB,EAA2B,IAA3B,EAAiCxD,KADnC,GAEE1C,IAAI6E,OAAJ,CAAYzE,IAH1B;AAKMwH,iBALN,GAKczD,IAAIyD,KALlB;AAMMjE,oBANN,GAMiB,4CAAAmE,CAAK3D,IAAIR,QAAT,CANjB;AAAA;AAAA,mBAOwB3D,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,MAAlC,EAA0CC,IAA1C,CAA+C,EAAE6C,YAAF,EAA/C,EAA0D5C,OAA1D,EAPxB;;AAAA;AAOMmD,qBAPN;;AAAA,gBASOA,UAAUjD,MATjB;AAAA;AAAA;AAAA;;AAUI5E,YAAA,wFAAAA,CAAcN,GAAd,EAAmBC,IAAnB,EAAyB,2BAAzB;AAVJ;AAAA;;AAAA;AAYQsD,gBAZR,GAYe4E,UAAU,CAAV,CAZf;;AAAA,kBAaQ5E,KAAKI,QAAL,KAAkBA,QAb1B;AAAA;AAAA;AAAA;;AAcM;AACIoE,iBAfV,GAekB,kFAAAC,CAAYJ,KAAZ,CAflB;AAgBUlF,iBAhBV,GAgBkB,EAAEkF,YAAF,EAhBlB;AAiBUf,kBAjBV,GAiBmB,EAAE,QAAQtD,IAAV,EAjBnB;;AAkBMA,iBAAKwE,KAAL,GAAaA,KAAb;;AAlBN;AAAA,mBAoByB/H,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,MAAlC,EAA0CsC,SAA1C,CAAoD1E,KAApD,EAA2DmE,MAA3D,CApBzB;;AAAA;AAoBUnB,kBApBV;;;AAsBM1F,gBAAIoI,OAAJ,CAAYC,GAAZ,CAAgB,OAAhB,EAAyBN,KAAzB;AACAvH,YAAA,0FAAAA,CAAgBR,GAAhB,EAAqBC,IAArB,EAA2B,EAAE2H,YAAF,EAASG,YAAT,EAA3B,CAA6C;;AAA7C,cAvBN;AAAA;;AAAA;AA0BMzH,YAAA,wFAAAA,CAAcN,GAAd,EAAmBC,IAAnB,EAAyB,yBAAzB;;AA1BN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;kBAAeqI,M;;;;;;yJA+Bf,kBAAoBtI,GAApB,EAAyBC,IAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AACMkE,eADN,GACYnE,IAAI6E,OAAJ,CAAYzE,IADxB;AAEM2H,iBAFN,GAEc5D,IAAI4D,KAFlB;AAAA;AAAA,mBAGwB/H,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,MAAlC,EAA0CC,IAA1C,CAA+C,EAAEgD,YAAF,EAA/C,EAA0D/C,OAA1D,EAHxB;;AAAA;AAGMmD,qBAHN;;;AAKE,gBAAI,CAACA,UAAUjD,MAAf,EAAuB;AACrB5E,cAAA,wFAAAA,CAAcN,GAAd,EAAmB,gBAAnB;AACD,aAFD,MAEO;AACDuD,kBADC,GACM4E,UAAU,CAAV,CADN;;AAEL3H,cAAA,0FAAAA,CAAgBR,GAAhB,EAAqB,EAAEuD,UAAF,EAArB;AACD;;AAVH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;kBAAemB,G;;;;;;;AAzEf;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4CAAe,UAAUxD,MAAV,EAAkB;AAC/BA,SAAOqH,GAAP,CAAW,kBAAX,EAA+BL,MAA/B;AACAhH,SAAOqH,GAAP,CAAW,kBAAX,EAA+BD,MAA/B;AACApH,SAAOoD,IAAP,CAAY,eAAZ,EAA6BI,GAA7B;AACD,C;;;;;;;ACZD,4CAAe;AACbjB,YAAU,QADG;AAEbE,YAAU;AAFG,CAAf,C;;;;;;;;ACAA;AAAA,IAAI6E,oBAAJ;AACA,IAAIC,kBAAJ;;AAEO,SAAShC,WAAT,CAAsBzG,GAAtB,EAA2B;AAChC,MAAI,CAACwI,WAAL,EAAkB;AAChBA,kBAAcxI,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,QAAlC,CAAd;AACD;AACD,SAAO0D,WAAP;AACD;;AAEM,SAASE,IAAT,CAAe1I,GAAf,EAAoB;AACzB,MAAI,CAACyI,SAAL,EAAgB;AACdA,gBAAYzI,IAAIsD,KAAJ,CAAUQ,EAAV,CAAa,QAAb,EAAuBgB,UAAvB,CAAkC,MAAlC,CAAZ;AACD;AACD,SAAO2D,SAAP;AACD,C;;;;;;;;;;;;;;;;;ACfD;;AAEO,SAAST,WAAT,CAAqBW,UAArB,EAAiC;AACtC,MAAMZ,QAAQ,oDAAAa,CAAIC,IAAJ,CAAS,EAAEF,YAAYA,UAAd,EAAT,EAAqC,SAArC,EAAgD,EAAEG,WAAW,MAAb,EAAhD,CAAd;AACA,SAAOf,KAAP;AACD;;AAED;AAAA,wJAAO,iBAA0B/H,GAA1B,EAA+BC,IAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBACFD,IAAI6E,OAAJ,CAAYkE,MAAZ,CAAmB,eAAnB,CADE;AAAA;AAAA;AAAA;;AAEChB,iBAFD,GAES/H,IAAI6E,OAAJ,CAAYkE,MAAZ,CAAmB,eAAnB,EAAoCC,KAApC,CAA0C,GAA1C,EAA+C,CAA/C,CAFT;AAGCC,mBAHD,GAGW,oDAAAL,CAAIM,MAAJ,CAAWnB,KAAX,EAAkB,SAAlB,CAHX;;AAAA,kBAKAA,SAASkB,QAAQE,GAAR,IAAe,IAAI5D,IAAJ,KAAW,IALnC;AAAA;AAAA;AAAA;;AAMDvF,gBAAIG,MAAJ,GAAa,GAAb;AACAH,gBAAII,IAAJ,GAAW;AACTgJ,uBAAS;AADA,aAAX;AAPC;AAAA;;AAAA;AAAA,6CAWMnJ,MAXN;;AAAA;AAAA;AAAA;;AAAA;AAcDD,gBAAIG,MAAJ,GAAa,GAAb;AACAH,gBAAII,IAAJ,GAAW;AACPgJ,uBAAS;AADF,aAAX;;AAfC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAP;;AAAA,kBAAsBC,UAAtB;AAAA;AAAA;AAAA,I;;;;;;ACPA,+B;;;;;;ACAA,yC;;;;;;ACAA,2C;;;;;;ACAA,sC;;;;;;ACAA,uC;;;;;;ACAA,yC;;;;;;ACAA,oC;;;;;;ACAA,kD;;;;;;ACAA,2C;;;;;;ACAA,wC;;;;;;ACAA,gD;;;;;;ACAA,iC;;;;;;ACAA,oC;;;;;;;;;;;;;;;;;ACUA;;wJACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACE;AACIC,kBAFN,GAEe,mBAAA7I,CAAQ,CAAR,CAFf;;AAGE6I,mBAAOC,GAAP,GAAa,EAAEtG,IAAIuG,GAAJ,KAAY,YAAd,CAAb;AACA;AAJF;AAAA,mBAKqB,IAAI,4CAAJ,CAASF,MAAT,CALrB;;AAAA;AAKQpG,gBALR;;AAAA,iBAOMoG,OAAOC,GAPb;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBASYrG,KAAKb,KAAL,EATZ;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,wBAWuB;AAXvB;;AAWM0D,oBAAQ0D,KAAR,cACAC,QAAQC,IAAR,CAAa,CAAb;;AAZN;;AAgBE3F,YAAA,+EAAAA,CAAOf,GAAP,EAAYC,IAAZ;;AAEAD,gBAAI2G,MAAJ,CAAW/F,IAAX,EAAiBD,IAAjB;AACAmC,oBAAQC,GAAR,CAAY,yBAAyBpC,IAAzB,GAAgC,GAAhC,GAAsCC,IAAlD,CAAwD;AAAxD;AAnBF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;kBAAegG,K;;;;;;;AAXf;;AAEA;;AAEA;;AAEA,IAAM5G,MAAM,IAAI,2CAAJ,EAAZ;AACA,IAAMW,OAAO8F,QAAQF,GAAR,CAAYM,IAAZ,IAAoB,SAAjC;AACA,IAAMjG,OAAO6F,QAAQF,GAAR,CAAYO,IAAZ,IAAoB,IAAjC;;AAyBAF,Q","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 29);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap bc5fdf29c8f4cf9bacbe","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/regenerator/index.js\n// module id = 0\n// module chunks = 0","export default {\n  SUCCESS: {\n    errno: 0,\n    errmsg: 'success'\n  },\n  MEMBER_EXIST: {\n    errno: 10000,\n    errmsg: '成员已添加过了'\n  },\n  MEMBER_ENROLLED: {\n    errno: 10001,\n    errmsg: '您已报过名'\n  },\n  MEMBER_NOT_CLASSMATE: {\n    errno: 10002,\n    errmsg: '您非本班成员，无法报名'\n  },\n  MEMBER_PAYED: {\n    errno: 10003,\n    errmsg: '您已交费'\n  },\n  USER_NAME_REGISTERED: {\n    errno: 20000,\n    errmsg: '用户姓名已注册'\n  },\n  USER_EMAIL_REGISTERED: {\n    errno: 20001,\n    errmsg: '用户邮箱已注册'\n  },\n  USER_EMAIL_NOT_REGISTERED: {\n    errno: 20002,\n    errmsg: '用户邮箱未注册'\n  },\n  USER_PASSWORD_INCORRECT: {\n    errno: 20003,\n    errmsg: '用户密码错误'\n  },\n  USER_NOT_EXIST: {\n    errno: 20004,\n    errmsg: '用户不存在'\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./utils/errno.js","import ERRORS from './errno'\n\nexport async function responseError(ctx, next, type) {\n  ctx.status = 200\n  ctx.body = {\n    errno: ERRORS[type].errno,\n    errmsg: ERRORS[type].errmsg\n  }\n  if (typeof next === 'function') {\n    await next()\n  }\n}\nexport async function responseSuccess(ctx, next, data = {}) {\n  ctx.status = 200\n  ctx.body = {\n    errno: 0,\n    errmsg: 'success',\n    data\n  }\n  if (typeof next === 'function') {\n    await next()\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./utils/ctx.js","module.exports = require(\"moment\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"moment\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"url\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"url\"\n// module id = 5\n// module chunks = 0","const { join, resolve } = require('path')\nconst fs = require('fs')\nconst webpack = require('webpack');\nconst content = fs.readFileSync(resolve('./assets/js/rem.js'), 'utf8')\n\nmodule.exports = {\n  /*\n  ** Headers of the page\n  */\n  router: {\n    middleware: 'check-auth'\n  },\n  head: {\n    title: 'love394',\n    meta: [\n      { charset: 'utf-8' },\n      { name: 'viewport', content: 'width=device-width, initial-scale=1, user-scalable=no' },\n      { name: 'format-detection', content: 'telephone=no' },\n      { hid: 'description', name: 'description', content: 'Nuxt.js project' }\n    ],\n    link: [\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' }\n    ],\n    script: [\n      {\n        innerHTML: content\n      }\n    ],\n    __dangerouslyDisableSanitizers: ['script']\n  },\n  /*\n  ** Global CSS\n  */\n  css: [\n    {\n      src: resolve('./assets/css/reset.styl'),\n      lang: 'stylus'\n    },\n    {\n      src: resolve('./assets/css/variable.styl'),\n      lang: 'stylus'\n    },\n    {\n      src: resolve('./assets/css/main.styl'),\n      lang: 'stylus'\n    } // 指定 scss 而非 sass\n  ],\n  /*\n  ** Customize the progress-bar color\n  */\n  loading: {\n    color: '#ffaca8'\n  },\n  build: {\n    module: {\n      rules: [\n        {\n          // 在页面中加载图片示例：var imgstr = require(\"./imgs/3.png\")\n          test: /\\.(jpe?g|png|gif|svg)$/i,\n          loaders: [\n            {\n              loader: 'url-loader',\n              query: {\n                limit: 8192,\n                name: 'images/[name].[hash].[ext]'\n              }\n            }\n          ]\n        },\n        {\n          test: /\\.html$/,\n          use: ['html-loader']\n        },\n        {\n          test: /\\.(pug|jade)$/,\n          use: ['pug-loader']\n        },\n        {\n          // 编译es6\n          test: /\\.js$/,\n          exclude: /node_modules/,\n          use: ['babel-loader']\n        }\n      ]\n    },\n    vendor: [\n      'axios'\n    ],\n    postcss: [\n      require('postcss-px2rem')({remUnit: 46.875})\n    ]\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","import path from 'path'\nimport Router from 'koa-router'\nimport createApi from '../api'\nimport auth from '../db/auth'\nimport mongo from 'koa-mongo'\nimport bodyParser from 'koa-bodyparser'\nimport session from 'koa-session2'\n\nexport default function(app, nuxt) {\n  const router = new Router()\n\n  createApi(router)\n\n  app\n    .use(session({\n      key: \"SESSIONID\"\n    }))\n\n  app\n    .use(mongo({\n      user: auth.username,\n      pass: auth.password,\n      host: '127.0.0.1',\n      port: 27017,\n      db: 'member'\n    }))\n    .use(bodyParser())\n    .use(router.routes())\n    .use(router.allowedMethods())\n    .use(async (ctx, next) => {\n      ctx.status = 200 // koa defaults to 404 when it sees that status is unset\n      await nuxt.render(ctx.req, ctx.res)\n    })\n}\n\n\n// WEBPACK FOOTER //\n// ./server/routes/index.js","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 9\n// module chunks = 0","import member from './member'\nimport user from './user'\nexport default function(router) {\n  member(router)\n  user(router)\n}\n\n\n// WEBPACK FOOTER //\n// ./server/api/index.js","import querystring from 'querystring'\nimport url from 'url'\nimport moment from 'moment'\nimport { ObjectId } from 'mongodb'\nimport { responseError, responseSuccess } from '../../utils/ctx'\nimport ERRORS from '../../utils/errno'\nimport { MemberModel } from '../db/index'\nexport default function (router) {\n  router.post('/api/member/add', add)\n  router.post('/api/member/edit', edit)\n  router.post('/api/member/remove', remove)\n  router.get('/api/member/list', findAll)\n  router.post('/api/member/list', editAll)\n}\n\nexport async function add (ctx, next) {\n  const req = ctx.request.body\n  const query = { name: req.name }\n  const exits = await ctx.mongo.db('member').collection('member').find(query).toArray()\n\n  if (exits.length) {\n    responseError(ctx, next, 'MEMBER_EXIST')\n  } else {\n    const member = {\n      name: req.name || '',\n      phone: req.phone || '',\n      is_payed: req.is_payed || 0,\n      is_enrolled: req.is_enrolled || 0,\n      enrolled_time: +new Date(),\n      payed_time: +new Date()\n    }\n    const result = await ctx.mongo.db('member').collection('member').insert(member)\n    responseSuccess(ctx, next)\n  }\n}\nexport async function remove (ctx, next) {\n  const query = ctx.request.body || {}\n  query._id = ObjectId(query._id)\n  try {\n    const result = await ctx.mongo.db('member').collection('member').deleteOne(query)\n    if (result.result.ok) {\n      responseSuccess(ctx, next)\n    }\n  } catch (e) {\n    console.log(e)\n  }\n}\nexport async function findOne (ctx, next) {\n  const query = ctx.request.body || {}\n  query._id = ObjectId(query._id)\n  ctx.body = await ctx.mongo.db('member').collection('member').find(query).toArray()\n}\nexport async function findAll(ctx, next) {\n  const query = url.parse(ctx.request.url, true).query\n  const skipNum = (query.page - 1) * 10\n  const limitNum = parseInt(query.pageSize)\n  try {\n    ctx.body = await MemberModel(ctx).find({}).skip(skipNum).limit(limitNum).toArray()\n  } catch (e) {\n    console.log(e)\n  }\n}\nexport async function editAll(ctx, next) {\n  const req = ctx.request.body\n  const list = req.data || []\n\n  try {\n    for (let i = 0; i < list.length; i++) {\n      let query = {\n        _id: ObjectId(list[i]._id)\n      }\n      let update = {\n        '$set': {\n          name: list[i].name,\n          phone: list[i].phone,\n          is_payed: list[i].is_payed,\n          is_enrolled: list[i].is_enrolled,\n          enrolled_time: list[i].enrolled_time,\n          pay_time: list[i].pay_time\n        }\n      }\n      try {\n        let result = await ctx.mongo.db('member').collection('member').update(query, update, { upsert: true })\n      } catch (e) {\n        console.log(e)\n      }\n    }\n    responseSuccess(ctx, next)\n  } catch (e) {\n    console.log(e)\n  }\n}\nexport async function edit (ctx, next) {\n  let req = ctx.request.body\n  let keys = Object.keys(req)\n  let query = {\n    name: req.name\n  }\n  let update = {}\n  const exist = await ctx.mongo.db('member').collection('member').find(query).toArray()\n\n  if (exist.length) {\n    if (req.is_enrolled && exist[0].is_enrolled) {\n      responseError(ctx, next, 'MEMBER_ENROLLED')\n    } else if (req.is_payed && exist[0].is_payed) {\n      responseError(ctx, next, 'MEMBER_PAYED')\n    } else {\n      update = _serielizeUpdate(req)\n      try {\n        const result = await ctx.mongo.db('member').collection('member').updateOne(query, update)\n        if (result.result.ok) {\n          responseSuccess(ctx, next)\n        } else {\n          console.log(result.result)\n        }\n      } catch (e) {\n        console.log(e)\n      }\n    }\n  } else {\n    responseError(ctx, next, 'MEMBER_NOT_CLASSMATE')\n  }\n}\n\nfunction _serielizeUpdate (req) {\n  let update = {}\n  let now = +new Date()\n  let query = req\n  let keys = Object.keys(req)\n  keys.forEach(item => {\n    if (!update['$set']) {\n      update['$set'] = {}\n    }\n    if (item !== '_id') {\n      if (item === 'is_enrolled' && query.is_enrolled === 1) {\n        update['$set']['enrolled_time'] = moment(now).format('YYYY-MM-DD HH:mm:ss')\n      }\n      if (item === 'is_payed' && query.is_payed === 1) {\n        update['$set']['payed_time'] = moment(now).format('YYYY-MM-DD HH:mm:ss')\n      }\n      update['$set'][item] = req[item]\n    }\n  })\n  return update\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/member.js","import moment from 'moment'\nimport objectIdToTimestamp from 'objectid-to-timestamp'\nimport sha1 from 'sha1'\nimport url from 'url'\nimport { createToken } from '../token'\nimport { responseError, responseSuccess } from '../../utils/ctx'\nimport ERRORS from '../../utils/errno'\n\nexport default function (router) {\n  router.all('/api/user/signup', signup)\n  router.all('/api/user/signin', signin)\n  router.post('/api/user/get', get)\n}\n\nasync function signup (ctx, next) {\n  let req = ctx.method === 'GET' \n              ? url.parse(ctx.request.url, true).query\n              : ctx.request.body\n  let existName = await ctx.mongo.db('member').collection('user').find({ username: req.username || ''}).toArray()\n  let existEmail = await ctx.mongo.db('member').collection('user').find({ email: req.email || ''}).toArray()\n\n  if (existName.length) {\n    responseError(ctx, next, 'USER_NAME_REGISTERED')\n  } else {\n    if (existEmail.length) {\n      responseError(ctx, next, 'USER_EMAIL_REGISTERED')\n    } else {\n      let now = +new Date()\n      let user = {\n        username: req.username,\n        email: req.email,\n        password: sha1(req.password), // 加密\n        token: createToken(req.email), // 创建token并存入数据库\n        create_time: moment(now).format('YYYY-MM-DD HH:mm:ss')\n      }\n      let result = await ctx.mongo.db('member').collection('user').insert(user)\n\n      responseSuccess(ctx, next)\n    }\n  }\n}\n\nasync function signin (ctx, next) {\n  let req = ctx.method === 'GET' \n            ? url.parse(ctx.request.url, true).query\n            : ctx.request.body\n\n  let email = req.email\n  let password = sha1(req.password);\n  let userExist = await ctx.mongo.db('member').collection('user').find({ email }).toArray()\n\n  if (!userExist.length) {\n    responseError(ctx, next, 'USER_EMAIL_NOT_REGISTERED')\n  } else {\n    let user = userExist[0]\n    if (user.password === password) {\n      //生成一个新的token,并存到数据库\n      let token = createToken(email)\n      let query = { email }\n      let update = { '$set': user}\n      user.token = token\n\n      let result = await ctx.mongo.db('member').collection('user').updateOne(query, update)\n\n      ctx.cookies.set('token', token)\n      responseSuccess(ctx, next, { email, token }) // TODO 登录成功要创建一个新的token,应该存入数据库\n\n    } else{\n      responseError(ctx, next, 'USER_PASSWORD_INCORRECT')\n    }\n  }\n}\n\nasync function get (ctx, next) {\n  let req = ctx.request.body\n  let token = req.token\n  let userExist = await ctx.mongo.db('member').collection('user').find({ token }).toArray()\n\n  if (!userExist.length) {\n    responseError(ctx, 'USER_NOT_EXIST')\n  } else {\n    let user = userExist[0]\n    responseSuccess(ctx, { user })\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/api/user.js","export default {\n  username: 'shuiyi',\n  password: 'Zyf$394394'\n}\n\n\n// WEBPACK FOOTER //\n// ./server/db/auth.js","let memberCache\nlet userCache\n\nexport function MemberModel (ctx) {\n  if (!memberCache) {\n    memberCache = ctx.mongo.db('member').collection('member')\n  }\n  return memberCache\n}\n\nexport function User (ctx) {\n  if (!userCache) {\n    userCache = ctx.mongo.db('member').collection('user')\n  }\n  return userCache\n}\n\n\n// WEBPACK FOOTER //\n// ./server/db/index.js","import jwt from 'jsonwebtoken'\n\nexport function createToken(user_email) {\n  const token = jwt.sign({ user_email: user_email }, 'love394', { expiresIn: '720h' })\n  return token\n}\n\nexport async function checkToken(ctx, next) {\n  if(ctx.request.header['authorization']){\n    let token = ctx.request.header['authorization'].split(' ')[1]\n    let decoded = jwt.decode(token, 'love394');\n\n    if(token && decoded.exp <= new Date()/1000){\n      ctx.status = 401;\n      ctx.body = {\n        message: 'token过期'\n      }\n    } else {\n      return next()\n    }\n  }else{\n      ctx.status = 401\n      ctx.body = {\n          message: '没有token'\n      }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/token/index.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"koa-mongo\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-mongo\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 20\n// module chunks = 0","module.exports = require(\"koa-session2\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-session2\"\n// module id = 21\n// module chunks = 0","module.exports = require(\"mongodb\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongodb\"\n// module id = 22\n// module chunks = 0","module.exports = require(\"objectid-to-timestamp\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"objectid-to-timestamp\"\n// module id = 23\n// module chunks = 0","module.exports = require(\"postcss-px2rem\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"postcss-px2rem\"\n// module id = 24\n// module chunks = 0","module.exports = require(\"querystring\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"querystring\"\n// module id = 25\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 26\n// module chunks = 0","module.exports = require(\"sha1\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sha1\"\n// module id = 27\n// module chunks = 0","module.exports = require(\"webpack\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpack\"\n// module id = 28\n// module chunks = 0","import Koa from 'koa'\n\nimport Nuxt from 'nuxt'\n\nimport routes from './routes'\n\nconst app = new Koa()\nconst host = process.env.HOST || '0.0.0.0'\nconst port = process.env.PORT || 3000\n\n// Start nuxt.js\nasync function start () {\n  // Import and Set Nuxt.js options\n  let config = require('../nuxt.config.js')\n  config.dev = !(app.env === 'production')\n  // Instanciate nuxt.js\n  const nuxt = await new Nuxt(config)\n  // Build in development\n  if (config.dev) {\n    try {\n      await nuxt.build()\n    } catch (e) {\n      console.error(e) // eslint-disable-line no-console\n      process.exit(1)\n    }\n  }\n\n  routes(app, nuxt)\n  \n  app.listen(port, host)\n  console.log('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\n}\n\nstart()\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js"],"sourceRoot":""}